#OLS regressions 

library(estimatr)
library(robustbase)
library(broom)
library(sandwich)
library(lmtest)
library(modelr)

#NOCHKEINEMODELLEMITOUTLIERN ERSTELLEN

##subsidy 
#dataset: mergedData

mealsNo_sub.lm <- lm(mealsNo ~ realSubsidy, data = mergedData)
summary(mealsNo_sub.lm)

mealsNo_sub.lm <- coeftest(mealsNo_sub.lm, vcov. = vcovHC(mealsNo_sub.lm, type = 'HC1'))
summary(mealsNo_sub.lm)

saveRDS(mealsNo_sub.lm,"./ANALYSIS/Tables/mealsNo_sub.lm.Rds")

tripsNo_sub.lm <- lm(tripsNo ~ realTripsSubsidy, data = mergedData)
summary(tripsNo_sub.lm)

tripsNo_sub.lm <- coeftest(tripsNo_sub.lm, vcov. = vcovHC(tripsNo_sub.lm, type = 'HC1'))
summary(tripsNo_sub.lm)

saveRDS(tripsNo_sub.lm,"./ANALYSIS/Tables/tripsNo_sub.lm.Rds")


#dataset with excluded outliers: mealsNo / tripsNo

mealsNo_sub_ex.lm <- lm(mealsNo ~ realSubsidy, data = mealsNoEliminated)
summary(mealsNo_sub_ex.lm)

mealsNo_sub_ex.lm <- coeftest(mealsNo_sub_ex.lm, vcov. = vcovHC(mealsNo_sub_ex.lm, type = 'HC1'))
summary(mealsNo_sub_ex.lm)

saveRDS(mealsNo_sub_ex.lm,"./ANALYSIS/Tables/mealsNo_sub_ex.lm.Rds")

tripsNo_sub_ex.lm <- lm(tripsNo ~ realTripsSubsidy, data = tripsNoEliminated)
summary(tripsNo_sub_ex.lm)

tripsNo_sub_ex.lm <- coeftest(tripsNo_sub_ex.lm, vcov. = vcovHC(tripsNo_sub_ex.lm, type = 'HC1'))
summary(tripsNo_sub_ex.lm)

saveRDS(tripsNo_sub_ex.lm,"./ANALYSIS/Tables/tripsNo_sub_ex.lm.Rds")



# #datset: mergedDataImputeInterpolation

mealsNo_sub_IM.lm <- lm(mealsNo ~ realSubsidy, data = mergedDataImputeInterpolation)
summary(mealsNo_sub.lm)

mealsNo_sub_IM.lm <- coeftest(mealsNo_sub_IM.lm, vcov. = vcovHC(mealsNo_sub_IM.lm, type = 'HC1'))
summary(mealsNo_sub_IM.lm)

saveRDS(mealsNo_sub_IM.lm,"./ANALYSIS/Tables/mealsNo_sub_IM.lm.Rds")

tripsNo_sub_IM.lm <- lm(tripsNo ~ realTripsSubsidy, data = mergedDataImputeInterpolation)
summary(tripsNo_sub.lm)

tripsNo_sub_IM.lm <- coeftest(tripsNo_sub_IM.lm, vcov. = vcovHC(tripsNo_sub_IM.lm, type = 'HC1'))
summary(tripsNo_sub_IM.lm)

saveRDS(tripsNo_sub_IM.lm,"./ANALYSIS/Tables/tripsNo_sub_IM.lm.Rds")
 



##healthinfluence 

#dataset: mergedData


lessIll_DGE.lm <- lm(lessIll ~ DGECriteriaNo, data = mergedData)
summary(lessIll_DGE.lm)

lessIll_DGE.lm <- coeftest(lessIll_DGE.lm, vcov. = vcovHC(lessIll_DGE.lm, type = 'HC1'))
summary(lessIll_DGE.lm)

saveRDS(lessIll_DGE.lm,"./ANALYSIS/Tables/lessIll_DGE.lm.Rds")

lessIll_DGE_scaled.lm <- lm(lessIll_scaled ~ DGECriteriaNoScaled, data = mergedData)
summary(lessIll_DGE_scaled.lm) #standardized

lessIll_DGE_Scaled.lm <- coeftest(lessIll_DGE_scaled.lm, vcov. = vcovHC(lessIll_DGE_scaled.lm, type = 'HC1'))
summary(lessIll_DGE_scaled.lm)

saveRDS(lessIll_DGE_scaled.lm,"./ANALYSIS/Tables/lessIll_DGE_scaled.lm.Rds")


Expand_LessIll.lm = lm(lessIll_weighted ~ DGECriteriaNo + regionalProducts + yearsSupportSince + realSubsidy + state, data = mergedData)
summary(Expand_LessIll.lm)

Expand_LessIll.lm <- coeftest(Expand_LessIll.lm, vcov. = vcovHC(Expand_LessIll.lm, type = 'HC1'))
summary(Expand_LessIll.lm)

saveRDS(Expand_LessIll.lm,"./ANALYSIS/Tables/Expand_LessIll.lm.Rds")

Expand_LessIll_scaled.lm = lm(lessIll_scaled ~ DGECriteriaNoScaled + regionalProducts_scaled + yearsSupportSince + realSubsidy + state, data = mergedData)
summary(Expand_LessIll_scaled.lm) #standardized

Expand_LessIll_scaled.lm <- coeftest(Expand_LessIll_scaled.lm, vcov. = vcovHC(Expand_LessIll_scaled.lm, type = 'HC1'))
summary(Expand_LessIll_scaled.lm)

saveRDS(Expand_LessIll_scaled.lm,"./ANALYSIS/Tables/Expand_LessIll_scaled.Rds")

dietaryKnowledge_DGE.lm <- lm(dietaryKnowledge ~ DGECriteriaNo, data = mergedData)
summary(dietaryKnowledge_DGE.lm)

dietaryKnowledge_DGE.lm <- coeftest(dietaryKnowledge_DGE.lm, vcov. = vcovHC(dietaryKnowledge_DGE.lm, type = 'HC1'))
summary(dietaryKnowledge_DGE.lm)

saveRDS(dietaryKnowledge_DGE.lm,"./ANALYSIS/Tables/dietaryKnowledge_DGE.lm.Rds")

dietaryKnowledge_DGE_scaled.lm <- lm(dietaryKnowledge_scaled ~ DGECriteriaNoScaled, data = mergedData)
summary(dietaryKnowledge_DGE_scaled.lm) #standardized

dietaryKnowledge_DGE_scaled.lm <- coeftest(dietaryKnowledge_DGE_scaled.lm, vcov. = vcovHC(dietaryKnowledge_DGE_scaled.lm, type = 'HC1'))
summary(dietaryKnowledge_DGE_scaled.lm)

saveRDS(dietaryKnowledge_DGE_scaled.lm,"./ANALYSIS/Tables/dietaryKnowledge_DGE_scaled.Rds")

appreciateHealthy_DGE.lm <- lm(appreciateHealthy ~ DGECriteriaNo, data = mergedData)
summary(appreciateHealthy_DGE.lm)

appreciateHealthy_DGE.lm <- coeftest(appreciateHealthy_DGE.lm, vcov. = vcovHC(appreciateHealthy_DGE.lm, type = 'HC1'))
summary(appreciateHealthy_DGE.lm)

saveRDS(appreciateHealthy_DGE.lm,"./ANALYSIS/Tables/appreciateHealthy_DGE.Rds")

appreciateHealthy_DGE_scaled.lm <- lm(appreciateHealthy_scaled ~ DGECriteriaNoScaled, data = mergedData)
summary(appreciateHealthy_DGE_scaled.lm) #standardized

appreciateHealthy_DGE_scaled.lm <- coeftest(appreciateHealthy_DGE_scaled.lm, vcov. = vcovHC(appreciateHealthy_DGE_scaled.lm, type = 'HC1'))
summary(appreciateHealthy_DGE_scaled.lm)

saveRDS(appreciateHealthy_DGE_scaled.lm,"./ANALYSIS/Tables/appreciateHealthy_DGE_scaled.Rds")


#dataset: mergedDataImputeInterpolation
 
lessIll_DGE_IM.lm <- lm(lessIll ~ DGECriteriaNo, data = mergedDataImputeInterpolation)
summary(lessIll_DGE_IM.lm)

lessIll_DGE_IM.lm <- coeftest(lessIll_DGE_IM.lm, vcov. = vcovHC(lessIll_DGE_IM.lm, type = 'HC1'))
summary(lessIll_DGE_IM.lm)

saveRDS(lessIll_DGE_IM.lm,"./ANALYSIS/Tables/lessIll_DGE_IM.lm.Rds")



lessIll_DGE_IM_scaled.lm <- lm(lessIll_scaled ~ DGECriteriaNoScaled, data = mergedDataImputeInterpolation)
summary(lessIll_DGE_IM_scaled.lm) #standardized

lessIll_DGE_IM_scaled.lm <- coeftest(lessIll_DGE_IM_scaled.lm, vcov. = vcovHC(lessIll_DGE_IM_scaled.lm, type = 'HC1'))
summary(lessIll_DGE_IM_scaled.lm)

saveRDS(lessIll_DGE_IM_scaled.lm,"./ANALYSIS/Tables/lessIll_DGE_IM_scaled.lm.Rds")



Expand_LessIll_IM.lm = lm(lessIll ~ DGECriteriaNo + regionalProducts + yearsSupportSince + realSubsidy, data = mergedDataImputeInterpolation)
summary(Expand_LessIll_IM.lm)

Expand_LessIll_IM.lm <- coeftest(Expand_LessIll_IM.lm, vcov. = vcovHC(Expand_LessIll_IM.lm, type = 'HC1'))
summary(Expand_LessIll_IM.lm)

saveRDS(Expand_LessIll_IM.lm,"./ANALYSIS/Tables/Expand_LessIll_IM.lm.Rds")
# 
Expand_LessIll_IM_scaled.lm = lm(lessIll_scaled ~ DGECriteriaNoScaled + regionalProducts_scaled + yearsSupportSince + realSubsidy, data = mergedDataImputeInterpolation)
summary(Expand_LessIll_IM_scaled.lm) #standardized

Expand_LessIll_IM_scaled.lm <- coeftest(Expand_LessIll_IM_scaled.lm, vcov. = vcovHC(Expand_LessIll_IM_scaled.lm, type = 'HC1'))
summary(Expand_LessIll_IM_scaled.lm)

saveRDS(Expand_LessIll_IM_scaled.lm,"./ANALYSIS/Tables/Expand_LessIll_IM_scaled.lm.Rds")

# 
dietaryKnowledge_DGE_IM.lm <- lm(dietaryKnowledge ~ DGECriteriaNo, data = mergedDataImputeInterpolation)
summary(dietaryKnowledge_DGE_IM.lm)

dietaryKnowledge_DGE_IM.lm <- coeftest(dietaryKnowledge_DGE_IM.lm, vcov. = vcovHC(dietaryKnowledge_DGE_IM.lm, type = 'HC1'))
summary(dietaryKnowledge_DGE_IM.lm)

saveRDS(dietaryKnowledge_DGE_IM.lm,"./ANALYSIS/Tables/dietaryKnowledge_DGE_IM.lm.Rds")

# 
dietaryKnowledge_DGE_IM_scaled.lm <- lm(dietaryKnowledge_scaled ~ DGECriteriaNoScaled, data = mergedDataImputeInterpolation)
summary(dietaryKnowledge_DGE_IM_scaled.lm) #standardized

dietaryKnowledge_DGE_IM_scaled.lm <- coeftest(dietaryKnowledge_DGE_IM_scaled.lm, vcov. = vcovHC(dietaryKnowledge_DGE_IM_scaled.lm, type = 'HC1'))
summary(dietaryKnowledge_DGE_IM_scaled.lm)

saveRDS(dietaryKnowledge_DGE_IM_scaled.lm,"./ANALYSIS/Tables/dietaryKnowledge_DGE_IM_scaled.lm.Rds")

# 
appreciateHealthy_DGE_IM.lm <- lm(appreciateHealthy ~ DGECriteriaNo, data = mergedDataImputeInterpolation)
summary(appreciateHealthy_DGE_IM.lm)

appreciateHealthy_DGE_IM.lm <- coeftest(appreciateHealthy_DGE_IM.lm, vcov. = vcovHC(appreciateHealthy_DGE_IM.lm, type = 'HC1'))
summary(appreciateHealthy_DGE_IM.lm)

saveRDS(appreciateHealthy_DGE_IM.lm,"./ANALYSIS/Tables/appreciateHealthy_DGE_IM.lm.Rds")

# 
appreciateHealthy_DGE_IM_scaled.lm <- lm(appreciateHealthy_scaled ~ DGECriteriaNoScaled, data = mergedDataImputeInterpolation)
summary(appreciateHealthy_DGE_IM_scaled.lm) #standardized

appreciateHealthy_DGE_IM_scaled.lm <- coeftest(appreciateHealthy_DGE_IM_scaled.lm, vcov. = vcovHC(appreciateHealthy_DGE_IM_scaled.lm, type = 'HC1'))
summary(appreciateHealthy_DGE_IM_scaled.lm)

saveRDS(appreciateHealthy_DGE_IM_scaled.lm,"./ANALYSIS/Tables/appreciateHealthy_DGE_IM_scaled.lm.Rds")


###chance equality
##dataset: mergedData 

#lunch

selfworth.lm <- lm(selfworth_weighted ~ realSubsidy, data = mergedData)
summary(selfworth.lm)

selfworth.lm <- coeftest(selfworth.lm, vcov. = vcovHC(selfworth.lm, type = 'HC1'))
summary(selfworth.lm)

saveRDS(selfworth.lm,"./ANALYSIS/Tables/selfworth.lm.Rds")

selfworth_scaled.lm <- lm(selfworth_scaled ~ realSubsidy, data = mergedData)
summary(selfworth_scaled.lm) #standardized

selfworth_scaled.lm <- coeftest(selfworth_scaled.lm, vcov. = vcovHC(selfworth_scaled.lm, type = 'HC1'))
summary(selfworth_scaled.lm)

saveRDS(selfworth_scaled.lm,"./ANALYSIS/Tables/selfworth_scaled.Rds")

dayToDaySkills.lm <- lm(dayToDaySkills_weighted ~ realSubsidy, data = mergedData)
summary(dayToDaySkills.lm)

dayToDaySkills.lm <- coeftest(dayToDaySkills.lm, vcov. = vcovHC(dayToDaySkills.lm, type = 'HC1'))
summary(dayToDaySkills.lm)

saveRDS(dayToDaySkills.lm,"./ANALYSIS/Tables/dayToDaySkills.lm.Rds")

dayToDaySkills_scaled.lm <- lm(dayToDaySkills_scaled ~ realSubsidy, data = mergedData)
summary(dayToDaySkills_scaled.lm) #standardized

dayToDaySkills_scaled.lm <- coeftest(dayToDaySkills_scaled.lm, vcov. = vcovHC(dayToDaySkills_scaled.lm, type = 'HC1'))
summary(dayToDaySkills_scaled.lm)

saveRDS(dayToDaySkills_scaled.lm,"./ANALYSIS/Tables/dayToDaySkills_scaled.lm.Rds")
 
#trips
selfworthTrips.lm <- lm(tripsSelfworth_weighted ~ realTripsSubsidy, data = mergedData)
summary(selfworthTrips.lm)

selfworthTrips.lm <- coeftest(selfworthTrips.lm, vcov. = vcovHC(selfworthTrips.lm, type = 'HC1'))
summary(selfworthTrips.lm)

saveRDS(selfworthTrips.lm,"./ANALYSIS/Tables/selfworthTrips.lm.Rds")

selfworthTrips_scaled.lm <- lm(tripsSelfworth_scaled ~ realTripsSubsidy, data = mergedData)
summary(selfworthTrips_scaled.lm) #standardized

selfworthTrips_scaled.lm <- coeftest(selfworthTrips_scaled.lm, vcov. = vcovHC(selfworthTrips_scaled.lm, type = 'HC1'))
summary(selfworthTrips_scaled.lm)

saveRDS(selfworthTrips_scaled.lm,"./ANALYSIS/Tables/selfworthTrips_scaled.Rds")

dayToDaySkillsTrips.lm <- lm(tripsDayToDaySkills_weighted ~ realTripsSubsidy, data = mergedData)
summary(dayToDaySkillsTrips.lm)

dayToDaySkillsTrips.lm <- coeftest(dayToDaySkillsTrips.lm, vcov. = vcovHC(dayToDaySkillsTrips.lm, type = 'HC1'))
summary(dayToDaySkillsTrips.lm)

saveRDS(dayToDaySkillsTrips.lm,"./ANALYSIS/Tables/dayToDaySkillsTrips.lm.Rds")

dayToDaySkillsTrips_scaled.lm <- lm(tripsDayToDaySkills_scaled ~ realTripsSubsidy, data = mergedData)
summary(dayToDaySkillsTrips_scaled.lm) #standardized

dayToDaySkillsTrips_scaled.lm <- coeftest(dayToDaySkillsTrips_scaled.lm, vcov. = vcovHC(dayToDaySkillsTrips_scaled.lm, type = 'HC1'))
summary(dayToDaySkillsTrips_scaled.lm)

saveRDS(dayToDaySkillsTrips_scaled.lm,"./ANALYSIS/Tables/dayToDaySkillsTrips_scaled.lm.Rds")


#dataset: mergedDataImputeInterpolation
#lunch
selfworth_IM.lm <- lm(selfworth ~ realSubsidy, data = mergedDataImputeInterpolation)
summary(selfworth_IM.lm)

selfworth_IM.lm <- coeftest(selfworth_IM.lm, vcov. = vcovHC(selfworth_IM.lm, type = 'HC1'))
summary(selfworth_IM.lm)

saveRDS(selfworth_IM.lm,"./ANALYSIS/Tables/selfworth_IM.lm.Rds")

# 
selfworth_IM_scaled.lm <- lm(selfworth_scaled ~ realSubsidy, data = mergedDataImputeInterpolation)
summary(selfworth_IM_scaled.lm) #standardized

selfworth_IM_scaled.lm <- coeftest(selfworth_IM_scaled.lm, vcov. = vcovHC(selfworth_IM_scaled.lm, type = 'HC1'))
summary(selfworth_IM_scaled.lm) 

saveRDS(selfworth_IM_scaled.lm,"./ANALYSIS/Tables/selfworth_IM_scaled.lm.Rds")
# 
dayToDaySkills_IM.lm <- lm(dayToDaySkills ~ realSubsidy, data = mergedDataImputeInterpolation)
summary(dayToDaySkills_IM.lm)

dayToDaySkills_IM.lm <- coeftest(dayToDaySkills_IM.lm, vcov. = vcovHC(dayToDaySkills_IM.lm, type = 'HC1'))
summary(dayToDaySkills_IM.lm)

saveRDS(dayToDaySkills_IM.lm,"./ANALYSIS/Tables/dayToDaySkills_IM.lm.Rds")
# 
dayToDaySkills_IM_scaled.lm <- lm(dayToDaySkills_scaled ~ realSubsidy, data = mergedDataImputeInterpolation)
summary(dayToDaySkills_IM_scaled.lm) #standardized

dayToDaySkills_IM_scaled.lm <- coeftest(dayToDaySkills_IM_scaled.lm, vcov. = vcovHC(dayToDaySkills_IM_scaled.lm, type = 'HC1'))
summary(dayToDaySkills_IM_scaled.lm)

saveRDS(dayToDaySkills_IM_scaled.lm,"./ANALYSIS/Tables/dayToDaySkills_IM_scaled.lm.Rds")
# 
#trips 
selfworthTrips_IM.lm <- lm(tripsSelfworth ~ realTripsSubsidy, data = mergedDataImputeInterpolation)
summary(selfworthTrips_IM.lm)

selfworthTrips_IM.lm <- coeftest(selfworthTrips_IM.lm, vcov. = vcovHC(selfworthTrips_IM.lm, type = 'HC1'))
summary(selfworthTrips_IM.lm)

saveRDS(selfworthTrips_IM.lm,"./ANALYSIS/Tables/selfworthTrips_IM.lm.Rds")

# 
selfworthTrips_IM_scaled.lm <- lm(tripsSelfworth_scaled ~ realTripsSubsidy, data = mergedDataImputeInterpolation)
summary(selfworthTrips_IM_scaled.lm) #standardized

selfworthTrips_IM_scaled.lm <- coeftest(selfworthTrips_IM_scaled.lm, vcov. = vcovHC(selfworthTrips_IM_scaled.lm, type = 'HC1'))
summary(selfworthTrips_IM_scaled.lm) 

saveRDS(selfworthTrips_IM_scaled.lm,"./ANALYSIS/Tables/selfworthTrips_IM_scaled.lm.Rds")
# 
dayToDaySkillsTrips_IM.lm <- lm(tripsDayToDaySkills ~ realTripsSubsidy, data = mergedDataImputeInterpolation)
summary(dayToDaySkillsTrips_IM.lm)

dayToDaySkillsTrips_IM.lm <- coeftest(dayToDaySkillsTrips_IM.lm, vcov. = vcovHC(dayToDaySkillsTrips_IM.lm, type = 'HC1'))
summary(dayToDaySkillsTrips_IM.lm)

saveRDS(dayToDaySkillsTrips_IM.lm,"./ANALYSIS/Tables/dayToDaySkillsTrips_IM.lm.Rds")
# 
dayToDaySkillsTrips_IM_scaled.lm <- lm(tripsDayToDaySkills_scaled ~ realTripsSubsidy, data = mergedDataImputeInterpolation)
summary(dayToDaySkillsTrips_IM_scaled.lm) #standardized

dayToDaySkillsTrips_IM_scaled.lm <- coeftest(dayToDaySkillsTrips_IM_scaled.lm, vcov. = vcovHC(dayToDaySkillsTrips_IM_scaled.lm, type = 'HC1'))
summary(dayToDaySkillsTrips_IM_scaled.lm)

saveRDS(dayToDaySkillsTrips_IM_scaled.lm,"./ANALYSIS/Tables/dayToDaySkillsTrips_IM_scaled.lm.Rds")
# 

